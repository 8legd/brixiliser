{"version":3,"sources":["webpack:///./.cache/gatsby-browser-entry.js","webpack:///./.cache/public-page-renderer.js","webpack:///./src/components/header.js","webpack:///./src/components/layout.js","webpack:///./src/components/ImageUpload.js","webpack:///./.cache/public-page-renderer-prod.js","webpack:///./src/libs/available-lego-brick-colours.js","webpack:///./src/libs/colour-utils.js","webpack:///./src/libs/image-utils.js","webpack:///./src/libs/lego/data/available-lego-brick-colours.js","webpack:///./src/libs/lego/colour-interpolate.js","webpack:///./src/libs/lego/dimensions.js","webpack:///./src/libs/lego/calculateOptimalBricks.js","webpack:///./src/libs/renderLego.js","webpack:///./src/components/LegoRenderer.jsx","webpack:///./src/libs/crop-canvas.js"],"names":["__webpack_require__","r","__webpack_exports__","d","graphql","StaticQueryContext","StaticQuery","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","gatsby_link__WEBPACK_IMPORTED_MODULE_2__","gatsby_link__WEBPACK_IMPORTED_MODULE_2___default","a","_wait_for_route_change__WEBPACK_IMPORTED_MODULE_3__","_public_page_renderer__WEBPACK_IMPORTED_MODULE_4__","_public_page_renderer__WEBPACK_IMPORTED_MODULE_4___default","_parse_path__WEBPACK_IMPORTED_MODULE_5__","createContext","props","createElement","Consumer","staticQueryData","data","query","render","children","Error","propTypes","object","string","isRequired","func","m","module","exports","default","header","Object","es","state","pokemonid","dispatch","setPokemon","id","type","payload","_ref","siteTitle","react_default","style","background","marginBottom","margin","maxWidth","padding","gatsby_browser_entry","to","color","textDecoration","onClick","parseInt","layout_Layout","react","Fragment","Helmet_default","title","site","siteMetadata","meta","name","content","lang","_755544856","prop_types_default","node","ProdPageRenderer","location","pageResources","_loader__WEBPACK_IMPORTED_MODULE_4__","getResourcesForPathnameSync","pathname","react__WEBPACK_IMPORTED_MODULE_1___default","_page_renderer__WEBPACK_IMPORTED_MODULE_3__","assign","key","json","prop_types__WEBPACK_IMPORTED_MODULE_2___default","shape","uniqueColours","available_lego_brick_colours_uniqueColours","plates","map","plate","indexOf","push","toLowerCase","available_lego_brick_colours","colours","filter","colour","DeltaE","h2r","hex","result","exec","rgb2lab","rgb","x","y","z","g","b","Math","pow","labpalette","obj","getHex","toString","slice","mapColorToPalette","red","green","blue","diffDistance","mappedColor","lab","distance","i","length","inputColour","getDeltaE94","L","A","B","max","min","scaleImageData","ctx","imageData","scale","scaled","createImageData","width","height","subLine","row","col","sourcePixel","subarray","set","destRow","destCol","data_available_lego_brick_colours_uniqueColours","data_plates","available_lego_brick_colours_getUniqueColours","data_available_lego_brick_colours","data_colours","colour_interpolate_DeltaE","colour_interpolate_h2r","r2h","colour_interpolate_labpalette","colour_interpolate_rgb2lab","colour_interpolate_mapColorToPalette","colour_interpolate_lab2rgb","getNextBestColourMatch","exclusions","testPalette","colourAsHex","findIndex","ecol","input","getDeltaE00","lego_dimensions","brick","test","Name","matches","undefined","calculateOptimalBricks","originalImageData","currentColour","outputBricks","Uint8ClampedArray","topLeftPixelValue","topLeftAlpha","alpha","isTransparentBlock","ignore","index","floor","mergeBlocks","thisBrick","brickColour","brickSizes","getBrickSizesForColour","l","hbrickFit","genericBrickFit","fits","blocks","vbrickFit","mergeSingles","maxCount","ignoreSmallOnes","dimension","sort","reverse","sourceBrickIndex","additionalBricks","nextColBrick","j","jl","nextLineBrick","concat","every","val","values","checkInvalidPixels","invalidCount","hasSinglePixelBlock","excludedColours","spacer","drawStuds","brickSize","xCount","yCount","beginPath","arc","PI","fill","stroke","closePath","LegoRenderer_LegoRenderer","LegoRenderer","_this","_Component","call","this","sourceData","updateCanvas","componentDidMount","componentDidUpdate","URI","_this2","Promise","resolve","reject","canvas","document","context","getContext","image","Image","addEventListener","drawImage","getImageData","src","then","mapping","mappedColour","remapPixelColours","refs","offscreen_canvas","imageSmoothingEnabled","scaledImageData","putImageData","cropped","w","h","pix","cropImageFromCanvas","largestValue","tiles","ceil","optimalData","outputCanvas","optimalBricks","imageWidth","imageHeight","offsetX","offsetY","outputContext","clearRect","lineWidth","fillStyle","drawTile","fillRect","strokeRect","strokeStyle","color_default","lighten","xPos","yPos","renderImageDataAsLego","canvas_lego","console","error","drawImageData","pixelScaler","className","position","display","ref","react_measure","measureRef","contentRect","measure","objectWithoutPropertiesLoose_default","bounds"],"mappings":"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","file":"2-32d9857a2b7ab61e8d87.js","sourcesContent":["import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Link, {\n  withPrefix,\n  navigate,\n  push,\n  replace,\n  navigateTo,\n} from \"gatsby-link\"\nimport { waitForRouteChange } from \"./wait-for-route-change\"\nimport PageRenderer from \"./public-page-renderer\"\nimport parsePath from \"./parse-path\"\n\nconst StaticQueryContext = React.createContext({})\n\nconst StaticQuery = props => (\n  <StaticQueryContext.Consumer>\n    {staticQueryData => {\n      if (\n        props.data ||\n        (staticQueryData[props.query] && staticQueryData[props.query].data)\n      ) {\n        return (props.render || props.children)(\n          props.data ? props.data.data : staticQueryData[props.query].data\n        )\n      } else {\n        return <div>Loading (StaticQuery)</div>\n      }\n    }}\n  </StaticQueryContext.Consumer>\n)\n\nStaticQuery.propTypes = {\n  data: PropTypes.object,\n  query: PropTypes.string.isRequired,\n  render: PropTypes.func,\n  children: PropTypes.func,\n}\n\nfunction graphql() {\n  throw new Error(\n    `It appears like Gatsby is misconfigured. Gatsby related \\`graphql\\` calls ` +\n      `are supposed to only be evaluated at compile time, and then compiled away,. ` +\n      `Unfortunately, something went wrong and the query was left in the compiled code.\\n\\n.` +\n      `Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.`\n  )\n}\n\nexport {\n  Link,\n  withPrefix,\n  graphql,\n  parsePath,\n  navigate,\n  push, // TODO replace for v3\n  replace, // TODO remove replace for v3\n  navigateTo, // TODO: remove navigateTo for v3\n  StaticQueryContext,\n  StaticQuery,\n  PageRenderer,\n  waitForRouteChange,\n}\n","const preferDefault = m => (m && m.default) || m\n\nif (process.env.BUILD_STAGE === `develop`) {\n  module.exports = preferDefault(require(`./public-page-renderer-dev`))\n} else if (process.env.BUILD_STAGE === `build-javascript`) {\n  module.exports = preferDefault(require(`./public-page-renderer-prod`))\n} else {\n  module.exports = () => null\n}\n","import React from 'react'\nimport { Link } from 'gatsby'\nimport { connect } from 'react-redux'\n\nconst Header = ({ siteTitle, pokemonid, setPokemon }) => (\n  <div\n    style={{\n      background: '#D11013',\n      marginBottom: '1.45rem',\n    }}\n  >\n    <div\n      style={{\n        margin: '0 auto',\n        maxWidth: 960,\n        padding: '1.45rem 1.0875rem',\n      }}\n    >\n      <h1 style={{ margin: 0 }}>\n        <Link\n          to=\"/\"\n          style={{\n            color: 'white',\n            textDecoration: 'none',\n          }}\n        >\n          {siteTitle}\n        </Link>\n      </h1>\n      {pokemonid}\n      <button onClick={() => setPokemon(parseInt(pokemonid, 10) + 1)}>\n        Next\n      </button>\n      <button onClick={() => setPokemon(parseInt(pokemonid, 10) - 1)}>\n        Prev\n      </button>\n    </div>\n  </div>\n)\n\nexport default connect(\n  (state, props) => {\n    return {\n      pokemonid: state.pokemonid,\n    }\n  },\n  dispatch => {\n    return {\n      setPokemon: id => {\n        // console.log(id)\n        dispatch({\n          type: 'SET_POKEMON',\n          payload: {\n            id,\n          },\n        })\n      },\n    }\n  }\n)(Header)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Helmet from 'react-helmet'\nimport { StaticQuery, graphql } from 'gatsby'\n\nimport Header from './header'\nimport ImageUpload from './ImageUpload'\n\nimport './layout.css'\n\nconst Layout = ({ children }) => (\n  <StaticQuery\n    query={graphql`\n      query SiteTitleQuery {\n        site {\n          siteMetadata {\n            title\n          }\n        }\n      }\n    `}\n    render={data => (\n      <>\n        <Helmet\n          title={data.site.siteMetadata.title}\n          meta={[\n            { name: 'description', content: 'Sample' },\n            { name: 'keywords', content: 'sample, something' },\n          ]}\n        >\n          <html lang=\"en\" />\n        </Helmet>\n        <Header siteTitle={data.site.siteMetadata.title} />\n        <div\n          style={{\n            margin: '0 auto',\n            // background: '#999999',\n          }}\n        >\n          {/* <ImageUpload /> */}\n          {children}\n        </div>\n      </>\n    )}\n  />\n)\n\nLayout.propTypes = {\n  children: PropTypes.node.isRequired,\n}\n\nexport default Layout\n","import React, { Component } from 'react'\n\nexport default class ImageUpload extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      file: '',\n      imagePreviewUrl: '',\n    }\n    this._handleImageChange = this._handleImageChange.bind(this)\n    this._handleSubmit = this._handleSubmit.bind(this)\n  }\n\n  _handleSubmit(e) {\n    e.preventDefault()\n    // TODO: do something with -> this.state.file\n  }\n\n  _handleImageChange(e) {\n    e.preventDefault()\n\n    let reader = new FileReader()\n    let file = e.target.files[0]\n\n    reader.onloadend = () => {\n      this.setState({\n        file: file,\n        imagePreviewUrl: reader.result,\n      })\n    }\n\n    reader.readAsDataURL(file)\n  }\n\n  render() {\n    let { imagePreviewUrl } = this.state\n    let $imagePreview = null\n    if (imagePreviewUrl) {\n      $imagePreview = <img src={imagePreviewUrl} width=\"100\" alt=\"\" />\n    }\n\n    return (\n      <div>\n        <form onSubmit={this._handleSubmit}>\n          <input type=\"file\" onChange={this._handleImageChange} />\n          <button type=\"submit\" onClick={this._handleSubmit}>\n            Upload Image\n          </button>\n        </form>\n        {$imagePreview}\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport InternalPageRenderer from \"./page-renderer\"\nimport loader from \"./loader\"\n\nconst ProdPageRenderer = ({ location }) => {\n  const pageResources = loader.getResourcesForPathnameSync(location.pathname)\n  return React.createElement(InternalPageRenderer, {\n    key: location.pathname,\n    location,\n    pageResources,\n    ...pageResources.json,\n  })\n}\n\nProdPageRenderer.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default ProdPageRenderer\n","import platesData from '../data/plates.json'\nimport colours from '../data/colours.json'\n\nconst uniqueColours = getUniqueColours()\n\nconst filteredColours = colours.filter(colour => {\n  return uniqueColours.indexOf(colour.name.toLowerCase()) !== -1\n})\n\nexport default filteredColours\n\nfunction getUniqueColours() {\n  let uniqueColours = []\n  platesData.map(plate => {\n    if (uniqueColours.indexOf(plate['Exact Colour'] !== -1)) {\n      uniqueColours.push(plate['Exact Colour'].toLowerCase())\n    }\n  })\n  return uniqueColours\n}\n","import legoPalette from './available-lego-brick-colours'\n\nconst DeltaE = require('delta-e')\n\nexport const h2r = hex => {\n  let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\n  return result\n    ? [\n        parseInt(result[1], 16),\n        parseInt(result[2], 16),\n        parseInt(result[3], 16),\n      ]\n    : null\n}\n\nexport const lab2rgb = lab => {\n  var y = (lab[0] + 16) / 116,\n    x = lab[1] / 500 + y,\n    z = y - lab[2] / 200,\n    r,\n    g,\n    b\n\n  x = 0.95047 * (x * x * x > 0.008856 ? x * x * x : (x - 16 / 116) / 7.787)\n  y = 1.0 * (y * y * y > 0.008856 ? y * y * y : (y - 16 / 116) / 7.787)\n  z = 1.08883 * (z * z * z > 0.008856 ? z * z * z : (z - 16 / 116) / 7.787)\n\n  r = x * 3.2406 + y * -1.5372 + z * -0.4986\n  g = x * -0.9689 + y * 1.8758 + z * 0.0415\n  b = x * 0.0557 + y * -0.204 + z * 1.057\n\n  r = r > 0.0031308 ? 1.055 * Math.pow(r, 1 / 2.4) - 0.055 : 12.92 * r\n  g = g > 0.0031308 ? 1.055 * Math.pow(g, 1 / 2.4) - 0.055 : 12.92 * g\n  b = b > 0.0031308 ? 1.055 * Math.pow(b, 1 / 2.4) - 0.055 : 12.92 * b\n\n  return [\n    Math.max(0, Math.min(1, r)) * 255,\n    Math.max(0, Math.min(1, g)) * 255,\n    Math.max(0, Math.min(1, b)) * 255,\n  ]\n}\n\nexport const rgb2lab = rgb => {\n  var r = rgb[0] / 255,\n    g = rgb[1] / 255,\n    b = rgb[2] / 255,\n    x,\n    y,\n    z\n\n  r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92\n  g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92\n  b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92\n\n  x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047\n  y = (r * 0.2126 + g * 0.7152 + b * 0.0722) / 1.0\n  z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883\n\n  x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116\n  y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116\n  z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116\n\n  return [116 * y - 16, 500 * (x - y), 200 * (y - z)]\n}\n\nconst palette = legoPalette.map(obj => {\n  let rgb = h2r(obj.hex)\n  return {\n    r: rgb[0],\n    g: rgb[1],\n    b: rgb[2],\n  }\n})\n\nconst labpalette = legoPalette.map(obj => {\n  let rgb = rgb2lab(h2r(obj.hex))\n  return rgb\n})\n\nexport const getHex = (r, g, b) => {\n  return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1, 7)\n}\n\nexport const remapPixelColours = originalImageData => {\n  let mapping = {}\n\n  let imageData = {\n    width: originalImageData.width,\n    height: originalImageData.height,\n    data: new Uint8ClampedArray(originalImageData.data),\n  }\n\n  for (var i = 0; i < imageData.data.length; i += 4) {\n    let mappedColour = mapColorToPalette(\n      imageData.data[i],\n      imageData.data[i + 1],\n      imageData.data[i + 2]\n    )\n    if (\n      !mapping[\n        getHex(imageData.data[i], imageData.data[i + 1], imageData.data[i + 2])\n      ]\n    ) {\n      mapping[\n        getHex(imageData.data[i], imageData.data[i + 1], imageData.data[i + 2])\n      ] = getHex(mappedColour.r, mappedColour.g, mappedColour.b)\n    }\n    imageData.data[i] = mappedColour.r\n    imageData.data[i + 1] = mappedColour.g\n    imageData.data[i + 2] = mappedColour.b\n  }\n\n  // console.log(imageData, mapping)\n  return { imageData, mapping }\n}\n\nexport const mapColorToPalette = (red, green, blue) => {\n  // console.log(r2h([red, green, blue]))\n  // return nearestColor(r2h([red, green, blue]))\n  let color, diffR, diffG, diffB, diffDistance, mappedColor\n  let distance = 25000\n  for (let i = 0; i < labpalette.length; i++) {\n    color = labpalette[i]\n    // diffR = (color.r - red)\n    // diffG = (color.g - green)\n    // diffB = (color.b - blue)\n    // diffDistance = diffR * diffR + diffG * diffG + diffB * diffB\n    let inputColour = rgb2lab([red, green, blue])\n    diffDistance = DeltaE.getDeltaE94(\n      { L: color[0], A: color[1], B: color[2] },\n      { L: inputColour[0], A: inputColour[1], B: inputColour[2] }\n    )\n    // console.log(color, red, green, blue, diffDistance)\n    if (diffDistance < distance) {\n      distance = diffDistance\n      mappedColor = lab2rgb(labpalette[i])\n    }\n  }\n  return {\n    r: mappedColor[0],\n    g: mappedColor[1],\n    b: mappedColor[2],\n  }\n}\n","export const convertURIToImageData = URI => {\n  return new Promise(function(resolve, reject) {\n    if (URI == null) return reject()\n    var canvas = document.createElement('canvas'),\n      context = canvas.getContext('2d'),\n      image = new Image()\n    image.addEventListener(\n      'load',\n      function() {\n        canvas.width = image.width\n        canvas.height = image.height\n        context.drawImage(this, 0, 0, canvas.width, canvas.height)\n        resolve(context.getImageData(0, 0, canvas.width, canvas.height))\n      },\n      false\n    )\n    image.src = URI\n  })\n}\n\nexport const scaleImageData = (ctx, imageData, scale) => {\n  var scaled = ctx.createImageData(\n    imageData.width * scale,\n    imageData.height * scale\n  )\n  var subLine = ctx.createImageData(scale, 1).data\n  for (var row = 0; row < imageData.height; row++) {\n    for (var col = 0; col < imageData.width; col++) {\n      var sourcePixel = imageData.data.subarray(\n        (row * imageData.width + col) * 4,\n        (row * imageData.width + col) * 4 + 4\n      )\n      for (var x = 0; x < scale; x++) subLine.set(sourcePixel, x * 4)\n      for (var y = 0; y < scale; y++) {\n        var destRow = row * scale + y\n        var destCol = col * scale\n        scaled.data.set(subLine, (destRow * scaled.width + destCol) * 4)\n      }\n    }\n  }\n\n  return scaled\n}\n","import platesData from './plates.json'\nimport colours from './colours.json'\n\nconst uniqueColours = getUniqueColours()\n\nconst filteredColours = colours.filter((colour) => {\n  return uniqueColours.indexOf(colour.name.toLowerCase()) !== -1\n})\n\nexport default filteredColours\n\nfunction getUniqueColours () {\n  let uniqueColours = []\n  platesData.map((plate) => {\n    if (uniqueColours.indexOf(plate['Exact Colour'] !== -1)) {\n      uniqueColours.push(plate['Exact Colour'].toLowerCase())\n    }\n  })\n  return uniqueColours\n}\n","import legoPalette from './data/available-lego-brick-colours'\n\nvar DeltaE = require('delta-e')\n\n// Converts a #ffffff hex string into an [r,g,b] array\nexport function h2r(hex) {\n  let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\n  return result\n    ? [\n        parseInt(result[1], 16),\n        parseInt(result[2], 16),\n        parseInt(result[3], 16),\n      ]\n    : null\n}\n\n// Inverse of the above\nexport function r2h(rgb) {\n  // return '#' + ((1 << 24) + (rgb[0] << 16) + (rgb[1] << 8) + rgb[2]).toString(16).slice(1)\n  // rgb = rgb.match(/^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/)\n  function hex(x) {\n    return ('0' + parseInt(x).toString(16)).slice(-2)\n  }\n  return '#' + hex(rgb[0]) + hex(rgb[1]) + hex(rgb[2])\n}\n\n// Interpolates two [r,g,b] colors and returns an [r,g,b] of the result\n// Taken from the awesome ROT.js roguelike dev library at\n// https://github.com/ondras/rot.js\nexport function _interpolateColor(color1, color2, factor) {\n  if (arguments.length < 3) {\n    factor = 0.5\n  }\n  let result = color1.slice()\n  for (let i = 0; i < 3; i++) {\n    result[i] = Math.round(result[i] + factor * (color2[i] - color1[i]))\n  }\n  return result\n}\n\nexport function rgb2hsl(color) {\n  let r = color[0] / 255\n  let g = color[1] / 255\n  let b = color[2] / 255\n\n  let max = Math.max(r, g, b),\n    min = Math.min(r, g, b)\n  let h,\n    s,\n    l = (max + min) / 2\n\n  if (max == min) {\n    h = s = 0 // achromatic\n  } else {\n    let d = max - min\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min)\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0)\n        break\n      case g:\n        h = (b - r) / d + 2\n        break\n      case b:\n        h = (r - g) / d + 4\n        break\n    }\n    h /= 6\n  }\n\n  return [h, s, l]\n}\n\nexport function hsl2rgb(color) {\n  let l = color[2]\n\n  if (color[1] == 0) {\n    l = Math.round(l * 255)\n    return [l, l, l]\n  } else {\n    function hue2rgb(p, q, t) {\n      if (t < 0) {\n        t += 1\n      }\n      if (t > 1) {\n        t -= 1\n      }\n      if (t < 1 / 6) {\n        return p + (q - p) * 6 * t\n      }\n      if (t < 1 / 2) {\n        return q\n      }\n      if (t < 2 / 3) {\n        return p + (q - p) * (2 / 3 - t) * 6\n      }\n      return p\n    }\n\n    let s = color[1]\n    let q = l < 0.5 ? l * (1 + s) : l + s - l * s\n    let p = 2 * l - q\n    let r = hue2rgb(p, q, color[0] + 1 / 3)\n    let g = hue2rgb(p, q, color[0])\n    let b = hue2rgb(p, q, color[0] - 1 / 3)\n    return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)]\n  }\n}\n\nexport function _interpolateHSL(color1, color2, factor) {\n  if (arguments.length < 3) {\n    factor = 0.5\n  }\n  let hsl1 = rgb2hsl(color1)\n  let hsl2 = rgb2hsl(color2)\n  for (let i = 0; i < 3; i++) {\n    hsl1[i] += factor * (hsl2[i] - hsl1[i])\n  }\n  return hsl2rgb(hsl1)\n}\n\nconst palette = legoPalette.map(obj => {\n  let rgb = h2r(obj.hex)\n  return {\n    r: rgb[0],\n    g: rgb[1],\n    b: rgb[2],\n  }\n})\n\nconst labpalette = legoPalette.map(obj => {\n  let rgb = rgb2lab(h2r(obj.hex))\n  return rgb\n})\n\n// var nearestColor = require('nearest-color').from(palette.map((c) => {\n//   return r2h([c.r, c.g, c.b])\n// }))\n// use Euclidian distance to find closest color\n// send in the rgb of the pixel to be substituted\nexport function mapColorToPalette(red, green, blue) {\n  // console.log(r2h([red, green, blue]))\n  // return nearestColor(r2h([red, green, blue]))\n  let color, diffR, diffG, diffB, diffDistance, mappedColor\n  let distance = 25000\n  for (let i = 0; i < labpalette.length; i++) {\n    color = labpalette[i]\n    // diffR = (color.r - red)\n    // diffG = (color.g - green)\n    // diffB = (color.b - blue)\n    // diffDistance = diffR * diffR + diffG * diffG + diffB * diffB\n    let inputColour = rgb2lab([red, green, blue])\n    diffDistance = DeltaE.getDeltaE94(\n      { L: color[0], A: color[1], B: color[2] },\n      { L: inputColour[0], A: inputColour[1], B: inputColour[2] }\n    )\n    // console.log(color, red, green, blue, diffDistance)\n    if (diffDistance < distance) {\n      distance = diffDistance\n      mappedColor = lab2rgb(labpalette[i])\n    }\n  }\n  return {\n    r: mappedColor[0],\n    g: mappedColor[1],\n    b: mappedColor[2],\n  }\n}\n\n/**\n * Takes a colour and finds its nearest not-matching colour.\n * @param {string} inputColour\n */\nexport function getNextBestColourMatch(inputColour, exclusions) {\n  let color, diffDistance, mappedColor\n  let distance = 25000\n  // let exclusionsAsLab = exclusions.map(colour => {\n  //   return rgb2lab(h2r(colour))\n  // })\n\n  let testPalette = labpalette.filter(colour => {\n    let colourAsHex = r2h(lab2rgb(colour))\n    let index = exclusions.findIndex(ecol => {\n      // return ecol[0] === colour[0] && ecol[1] === colour[1] && ecol[2] === colour[2]\n      return ecol === colourAsHex\n    })\n    return index === -1\n  })\n\n  for (let i = 0; i < testPalette.length; i++) {\n    color = testPalette[i]\n    let input = rgb2lab(h2r(inputColour))\n    diffDistance = DeltaE.getDeltaE00(\n      { L: color[0], A: color[1], B: color[2] },\n      { L: input[0], A: input[1], B: input[2] }\n    )\n    if (diffDistance < distance && diffDistance > 0) {\n      distance = diffDistance\n      mappedColor = lab2rgb(testPalette[i])\n    }\n  }\n  // console.log(diffDistance)\n  return r2h(mappedColor)\n}\n\nexport function lab2rgb(lab) {\n  var y = (lab[0] + 16) / 116,\n    x = lab[1] / 500 + y,\n    z = y - lab[2] / 200,\n    r,\n    g,\n    b\n\n  x = 0.95047 * (x * x * x > 0.008856 ? x * x * x : (x - 16 / 116) / 7.787)\n  y = 1.0 * (y * y * y > 0.008856 ? y * y * y : (y - 16 / 116) / 7.787)\n  z = 1.08883 * (z * z * z > 0.008856 ? z * z * z : (z - 16 / 116) / 7.787)\n\n  r = x * 3.2406 + y * -1.5372 + z * -0.4986\n  g = x * -0.9689 + y * 1.8758 + z * 0.0415\n  b = x * 0.0557 + y * -0.204 + z * 1.057\n\n  r = r > 0.0031308 ? 1.055 * Math.pow(r, 1 / 2.4) - 0.055 : 12.92 * r\n  g = g > 0.0031308 ? 1.055 * Math.pow(g, 1 / 2.4) - 0.055 : 12.92 * g\n  b = b > 0.0031308 ? 1.055 * Math.pow(b, 1 / 2.4) - 0.055 : 12.92 * b\n\n  return [\n    Math.max(0, Math.min(1, r)) * 255,\n    Math.max(0, Math.min(1, g)) * 255,\n    Math.max(0, Math.min(1, b)) * 255,\n  ]\n}\n\nexport function rgb2lab(rgb) {\n  var r = rgb[0] / 255,\n    g = rgb[1] / 255,\n    b = rgb[2] / 255,\n    x,\n    y,\n    z\n\n  r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92\n  g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92\n  b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92\n\n  x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047\n  y = (r * 0.2126 + g * 0.7152 + b * 0.0722) / 1.0\n  z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883\n\n  x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116\n  y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116\n  z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116\n\n  return [116 * y - 16, 500 * (x - y), 200 * (y - z)]\n}\n\n// calculate the perceptual distance between colors in CIELAB\n// https://github.com/THEjoezack/ColorMine/blob/master/ColorMine/ColorSpaces/Comparisons/Cie94Comparison.cs\n\n// export function deltaE (labA, labB) {\n//   var deltaL = labA[0] - labB[0]\n//   var deltaA = labA[1] - labB[1]\n//   var deltaB = labA[2] - labB[2]\n//   var c1 = Math.sqrt(labA[1] * labA[1] + labA[2] * labA[2])\n//   var c2 = Math.sqrt(labB[1] * labB[1] + labB[2] * labB[2])\n//   var deltaC = c1 - c2\n//   var deltaH = deltaA * deltaA + deltaB * deltaB - deltaC * deltaC\n//   deltaH = deltaH < 0 ? 0 : Math.sqrt(deltaH)\n//   var sc = 1.0 + 0.045 * c1\n//   var sh = 1.0 + 0.015 * c1\n//   var deltaLKlsl = deltaL / (1.0)\n//   var deltaCkcsc = deltaC / (sc)\n//   var deltaHkhsh = deltaH / (sh)\n//   var i = deltaLKlsl * deltaLKlsl + deltaCkcsc * deltaCkcsc + deltaHkhsh * deltaHkhsh\n//   return i < 0 ? 0 : Math.sqrt(i)\n// }\n\nfunction padToTwo(numberString) {\n  if (numberString.length < 2) {\n    numberString = '0' + numberString\n  }\n  return numberString\n}\n\nexport function hexAverage() {\n  var args = Array.prototype.slice.call(arguments)\n  // console.log(args, arguments)\n  return args\n    .reduce(\n      function(previousValue, currentValue) {\n        return currentValue\n          .replace(/^#/, '')\n          .match(/.{2}/g)\n          .map(function(value, index) {\n            return previousValue[index] + parseInt(value, 16)\n          })\n      },\n      [0, 0, 0]\n    )\n    .reduce(function(previousValue, currentValue) {\n      return (\n        previousValue +\n        padToTwo(Math.floor(currentValue / args.length).toString(16))\n      )\n    }, '#')\n}\n","import platesData from './data/plates.json'\nimport coloursData from './data/available-lego-brick-colours'\n\nconst dimensions = platesData\n    .filter((brick) => {\n      return /^PLATE\\s([0-9]*)X([0-9]*)$/gi.test(brick.Name)\n    })\n    .map((brick) => {\n      let matches = /^PLATE\\s([0-9]*)X([0-9]*)$/gi.exec(brick.Name)\n      let data = coloursData.filter((colour) => {\n        return brick['Exact Colour'].toLowerCase() === colour.name.toLowerCase()\n      })[0]\n      let hex = (data !== undefined) ? data.hex : undefined\n      return [matches[1], matches[2], hex]\n    })\n\nexport default dimensions\n","import {\n  r2h,\n  h2r,\n  getNextBestColourMatch,\n  hexAverage,\n  mapColorToPalette,\n} from './colour-interpolate'\nimport dimensions from './dimensions'\nvar DeltaE = require('delta-e')\n\nconst calculateFromImageData = originalImageData => {\n  let currentColour\n  let outputBricks = []\n\n  let imageData = {\n    width: originalImageData.width,\n    height: originalImageData.height,\n    data: new Uint8ClampedArray(originalImageData.data),\n  }\n\n  for (var i = 0; i < imageData.data.length; i += 4) {\n    let color = mapColorToPalette(\n      imageData.data[i],\n      imageData.data[i + 1],\n      imageData.data[i + 2]\n    )\n    imageData.data[i] = color.r\n    imageData.data[i + 1] = color.g\n    imageData.data[i + 2] = color.b\n    // let hexColor = r2h([imageData.data[i], imageData.data[i + 1], imageData.data[i + 2]]);\n    // if (!imageStats[hexColor]) {\n    //   imageStats[hexColor] = 0;\n    // }\n    // if (imageData.data[i + 3] === 255) {\n    //   imageStats[hexColor]++;\n    // }\n  }\n\n  // console.log(imageData.width, imageData.height)\n\n  let topLeftPixelValue = r2h([\n    imageData.data[0],\n    imageData.data[1],\n    imageData.data[2],\n  ])\n  let topLeftAlpha = imageData.data[3]\n\n  for (var i = 0; i < imageData.data.length; i += 4) {\n    currentColour = r2h([\n      imageData.data[i],\n      imageData.data[i + 1],\n      imageData.data[i + 2],\n    ])\n    let alpha = imageData.data[i + 3]\n\n    let isTransparentBlock =\n      alpha !== 255 ||\n      (currentColour === topLeftPixelValue && alpha === topLeftAlpha)\n    if (isTransparentBlock) {\n      currentColour = undefined\n    }\n    // let isTransparentBlock = false\n\n    outputBricks.push({\n      colour: currentColour,\n      ignore: !!isTransparentBlock,\n      index: i,\n      // ref: [imageData.data[i], imageData.data[i + 1], imageData.data[i + 2]]\n    })\n  }\n\n  for (let i = 0; i < outputBricks.length; i++) {\n    if (outputBricks[i]) {\n      outputBricks[i].x = i % imageData.width\n      outputBricks[i].y = Math.floor(i / imageData.width)\n      outputBricks[i].width = 1\n      outputBricks[i].height = 1\n    }\n  }\n\n  function mergeBlocks(outputBricks) {\n    for (let i = 0; i < outputBricks.length - 1; i++) {\n      let thisBrick = outputBricks[i]\n      let brickColour = thisBrick.colour\n      if (!thisBrick.ignore) {\n        let brickSizes = getBrickSizesForColour(brickColour, true)\n\n        for (let a = 0, l = brickSizes.length; a < l; a++) {\n          let hbrickFit = genericBrickFit(i, brickSizes[a][1], brickSizes[a][0])\n          // let vbrickFit = genericBrickFit(i, brickSizes[a][0], brickSizes[a][1])\n          if (hbrickFit.fits) {\n            thisBrick.width = brickSizes[a][1]\n            thisBrick.height = brickSizes[a][0]\n            hbrickFit.blocks.map(brick => {\n              // brick.colour = undefined\n              brick.ignore = true\n              // brick.width = 0\n              // brick.height = 0\n            })\n            break\n          }\n        }\n\n        for (let a = 0, l = brickSizes.length; a < l; a++) {\n          let vbrickFit = genericBrickFit(i, brickSizes[a][0], brickSizes[a][1])\n          if (vbrickFit.fits) {\n            thisBrick.width = brickSizes[a][0]\n            thisBrick.height = brickSizes[a][1]\n            vbrickFit.blocks.map(brick => {\n              // brick.colour = undefined\n              brick.ignore = true\n              // brick.width = 0\n              // brick.height = 0\n            })\n            break\n          }\n        }\n      }\n    }\n\n    mergeSingles(outputBricks)\n  }\n\n  mergeBlocks(outputBricks)\n\n  let maxCount = 0\n  checkInvalidPixels()\n\n  mergeBlocks(outputBricks)\n  // mergeSingles(outputBricks)\n\n  function checkInvalidPixels() {\n    maxCount++\n    let invalidCount = 0\n    for (let i = 0; i < outputBricks.length - 1; i++) {\n      let thisBrick = outputBricks[i]\n      let brickColour = thisBrick.colour\n      if (!thisBrick.ignore) {\n        let brickSizes = getBrickSizesForColour(brickColour, false)\n        let hasSinglePixelBlock =\n          brickSizes.filter(brick => {\n            return parseInt(brick[0], 10) === 1 && parseInt(brick[1], 10) === 1\n          }).length > 0\n\n        if (\n          parseInt(thisBrick.width, 10) === 1 &&\n          parseInt(thisBrick.height, 10) === 1 &&\n          !hasSinglePixelBlock\n        ) {\n          // todo: find the next nearest mapping for this colour\n          // thisBrick.colour = '#ff00ff'// getNextBestColourMatch(thisBrick.colour)\n          if (!outputBricks[i].excludedColours) {\n            outputBricks[i].excludedColours = []\n          }\n          // console.log('outputBricks[i].excludedColours = ', outputBricks[i].excludedColours)\n          // console.log(thisBrick)\n          outputBricks[i].excludedColours.push(thisBrick.colour)\n          thisBrick.colour = getNextBestColourMatch(\n            r2h([\n              originalImageData.data[thisBrick.index],\n              originalImageData.data[thisBrick.index + 1],\n              originalImageData.data[thisBrick.index + 2],\n            ]),\n            outputBricks[i].excludedColours\n          )\n          invalidCount++\n          // todo: re-run the pixel analysis from scratch with new imagedata\n        }\n      }\n    }\n    if (invalidCount > 0) {\n      // console.log(invalidCount, 'pixels invalid')\n      if (maxCount < 10) {\n        // mergeSingles(outputBricks)\n        checkInvalidPixels()\n      }\n      // } else {\n      //   console.log('all pixels okay!')\n    }\n  }\n\n  function getBrickSizesForColour(colour, ignoreSmallOnes) {\n    return dimensions\n      .filter(dimension => {\n        //  console.log(dimension[2], brickColour);\n        return dimension[2] === colour\n      })\n      .filter(dimension => {\n        let width = parseInt(dimension[0], 10)\n        let height = parseInt(dimension[1], 10)\n        if (ignoreSmallOnes) {\n          return width > 1 && height > 1\n        } else {\n          return width === 1 || height === 1\n        }\n      })\n      .sort((a, b) => {\n        return parseInt(a[0], 10) - parseInt(b[0], 10)\n      })\n      .reverse()\n  }\n\n  function mergeSingles(outputBricks) {\n    for (let i = 0; i < outputBricks.length - 1; i++) {\n      let thisBrick = outputBricks[i]\n      let brickColour = thisBrick.colour\n      if (!thisBrick.ignore) {\n        if (thisBrick.width == 1 && thisBrick.height == 1) {\n          let brickSizes = getBrickSizesForColour(brickColour, false)\n\n          for (let a = 0, l = brickSizes.length; a < l; a++) {\n            let hbrickFit = genericBrickFit(\n              i,\n              brickSizes[a][1],\n              brickSizes[a][0]\n            )\n            if (hbrickFit.fits) {\n              thisBrick.width = brickSizes[a][1]\n              thisBrick.height = brickSizes[a][0]\n              // thisBrick.ignore = false\n              // console.log(hbrickFit.blocks.length)\n              hbrickFit.blocks.map(brick => {\n                // brick.colour = undefined\n                brick.ignore = true\n                // brick.width = 0\n                // brick.height = 0\n              })\n              break\n            }\n          }\n\n          for (let a = 0, l = brickSizes.length; a < l; a++) {\n            let vbrickFit = genericBrickFit(\n              i,\n              brickSizes[a][0],\n              brickSizes[a][1]\n            )\n            if (vbrickFit.fits) {\n              thisBrick.width = brickSizes[a][0]\n              thisBrick.height = brickSizes[a][1]\n              // thisBrick.ignore = false\n              // console.log(vbrickFit.blocks.length)\n              vbrickFit.blocks.map(brick => {\n                // brick.colour = undefined\n                brick.ignore = true\n                // brick.width = 0\n                // brick.height = 0\n              })\n              break\n            }\n          }\n        }\n      }\n    }\n  }\n\n  function genericBrickFit(sourceBrickIndex, width, height) {\n    let thisBrick = outputBricks[sourceBrickIndex]\n    let additionalBricks = []\n    for (let i = 0, l = width; i < l; i++) {\n      if (i !== 0) {\n        let nextColBrick = outputBricks[sourceBrickIndex + i]\n        // if (!nextColBrick) {\n        //   additionalBricks.push(nextColBrick)\n        // }\n        if (nextColBrick) {\n          if (\n            nextColBrick.width == 1 &&\n            nextColBrick.height == 1 &&\n            !nextColBrick.ignore\n          ) {\n            additionalBricks.push(nextColBrick)\n          } else {\n            additionalBricks.push(undefined)\n          }\n        } else {\n          if (!nextColBrick) {\n            additionalBricks.push(nextColBrick)\n          }\n        }\n      }\n      for (let j = 1, jl = height; j < jl; j++) {\n        let nextLineBrick =\n          outputBricks[sourceBrickIndex + i + j * imageData.width]\n        // if (!nextLineBrick) {\n        //   additionalBricks.push(nextLineBrick)\n        // }\n        if (nextLineBrick) {\n          if (\n            nextLineBrick.width == 1 &&\n            nextLineBrick.height == 1 &&\n            !nextLineBrick.ignore\n          ) {\n            additionalBricks.push(nextLineBrick)\n          } else {\n            additionalBricks.push(undefined)\n          }\n        } else {\n          if (!nextLineBrick) {\n            additionalBricks.push(nextLineBrick)\n          }\n        }\n      }\n    }\n\n    let remainingDistanceToEdge = imageData.width - (i % imageData.width)\n    if (remainingDistanceToEdge < width) {\n      return {\n        fits: false,\n      }\n    }\n\n    // let unfilteredBricks = additionalBricks.length\n    // console.log(additionalBricks.filter((brick) => { return !brick }).length, unfilteredBricks)\n\n    if (\n      additionalBricks.filter(brick => {\n        return !brick\n      }).length\n    ) {\n      return { fits: false }\n    }\n\n    let values = [].concat(thisBrick, additionalBricks)\n\n    // const colour = values[0].colour\n\n    let yahtzeeQualify = values.every((val, i, values) => {\n      if (!(values[0].width == 1 && values[0].height == 1) || !!val.ignore) {\n        return false\n      }\n      // if ((val.width === 0 && val.height === 0) || val.ignore) {\n      //   return false\n      // }\n      return val.colour === values[0].colour\n    })\n\n    return {\n      fits: yahtzeeQualify,\n      blocks: additionalBricks,\n    }\n  }\n\n  const rtn = outputBricks.filter(brick => {\n    // return brick.colour !== undefined && !brick.ignore\n    return !brick.ignore\n  })\n\n  return rtn\n}\n\nexport default calculateFromImageData\n","// import remapPixelColours from './lego/remapPixelColours'\nimport Color from 'color'\n\nconst spacer = 0.25 //1;\n\n// function render() {\n//   this.width = this.$el.offsetWidth\n//   this.height = this.$el.offsetHeight\n\n//   let optimalBricks = this._props.optimalBricks\n\n//   if (!this._props.optimalBricks) {\n//     return\n//   }\n\n//   var canvas = this.$refs.canvas\n//   let ctx = canvas.getContext('2d')\n\n//   // ctx.imageSmoothingEnabled = false\n\n//   if (!this._props.imagedata || !this._props.imagedata.data) {\n//     return\n//   }\n\n//   let { imageData } = remapPixelColours(this._props.imagedata)\n\n//   // let optimalBricks = CalculateOptimalBricks.calculateFromImageData(imageData)\n//   let width = imageData.width\n//   let height = imageData.height\n//   // console.log(width, height)\n//   let imageSize = width < height ? height : width\n\n//   renderImageDataAsLego(ctx, canvas, imageSize, optimalBricks, width, height)\n// }\n\nexport function renderImageDataAsLego(\n  //   outputContext,\n  outputCanvas,\n  //   height,\n  optimalBricks,\n  imageWidth,\n  imageHeight,\n  offsetX,\n  offsetY\n) {\n  const height = imageWidth < imageHeight ? imageHeight : imageWidth\n  const outputContext = outputCanvas.getContext('2d')\n  outputContext.clearRect(0, 0, outputCanvas.width, outputCanvas.height)\n  let canvas = document.createElement('canvas')\n  canvas.width = outputCanvas.width\n  canvas.height = outputCanvas.height\n  let context = canvas.getContext('2d')\n  let brickSize = outputCanvas.height / height\n\n  context.lineWidth = 0.25\n  context.fillStyle = '#ffffff'\n\n  const drawTile = (row, col) => {\n    const size = 32\n    context.fillRect(\n      size * (row * brickSize),\n      size * (col * brickSize),\n      size * (row + 1) * brickSize,\n      size * (col + 1) * brickSize\n    )\n    context.strokeRect(\n      size * (row * brickSize),\n      size * (col * brickSize),\n      size * (row + 1) * brickSize,\n      size * (col + 1) * brickSize\n    )\n    // context.strokeRect(0, 32 * brickSize, 32 * brickSize, 32 * brickSize)\n    // context.strokeRect(32 * brickSize, 0, 32 * brickSize, 32 * brickSize)\n    // context.strokeRect(\n    //   32 * brickSize,\n    //   32 * brickSize,\n    //   32 * brickSize,\n    //   32 * brickSize\n    // )\n    drawStuds(context, brickSize, spacer, size * row, size * col, size, size)\n  }\n\n  drawTile(0, 0)\n  drawTile(0, 1)\n  drawTile(0, 2)\n  drawTile(1, 0)\n  drawTile(1, 1)\n  drawTile(1, 2)\n  drawTile(2, 0)\n  drawTile(2, 1)\n  drawTile(2, 2)\n\n  if (optimalBricks) {\n    for (let i = 0, l = optimalBricks.length; i < l; i++) {\n      // if (!optimalBricks[i].ignore) {\n      let xCount = optimalBricks[i].x + offsetX\n      let yCount = optimalBricks[i].y + offsetY\n      context.fillStyle = optimalBricks[i].colour\n      // if (Color(optimalBricks[i].colour).light()) {\n      context.strokeStyle = '#000000'\n      // } else {\n      //     context.strokeStyle = '#ffffff'\n      // }\n      context.fillRect(\n        xCount * brickSize + spacer,\n        yCount * brickSize + spacer,\n        optimalBricks[i].width * brickSize - spacer * 2,\n        optimalBricks[i].height * brickSize - spacer * 2\n      )\n      context.strokeRect(\n        xCount * brickSize + spacer,\n        yCount * brickSize + spacer,\n        optimalBricks[i].width * brickSize - spacer * 2,\n        optimalBricks[i].height * brickSize - spacer * 2\n      )\n\n      context.fillStyle = Color(optimalBricks[i].colour).lighten(0.1)\n      drawStuds(\n        context,\n        brickSize,\n        spacer,\n        xCount,\n        yCount,\n        optimalBricks[i].width,\n        optimalBricks[i].height\n      )\n      // }\n    }\n    let ratio = imageWidth / imageHeight\n    let isLandscape = ratio > 1\n    let xPos = 0\n    let yPos = 0\n    if (!isLandscape) {\n      xPos = ((imageHeight - imageWidth) / 2) * (outputCanvas.height / height)\n    } else {\n      yPos = ((imageWidth - imageHeight) / 2) * (outputCanvas.height / height)\n    }\n    outputContext.drawImage(canvas, xPos, yPos)\n  }\n}\n\nfunction drawStuds(ctx, brickSize, spacer, xCount, yCount, width, height) {\n  for (var i = 0, l = width; i < l; i++) {\n    for (var j = 0, jl = height; j < jl; j++) {\n      ctx.beginPath()\n      ctx.arc(\n        (xCount + i) * brickSize + -spacer / 2 + brickSize / 2,\n        (yCount + j) * brickSize + -spacer / 2 + brickSize / 2,\n        brickSize * 0.3,\n        0,\n        2 * Math.PI\n      )\n      ctx.fill()\n      ctx.stroke()\n      ctx.closePath()\n    }\n  }\n}\n\n// export default render\n","import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { withContentRect } from 'react-measure'\n\nimport { remapPixelColours } from '../libs/colour-utils'\nimport { convertURIToImageData, scaleImageData } from '../libs/image-utils'\nimport calculateFromImageData from '../libs/lego/calculateOptimalBricks'\nimport { renderImageDataAsLego } from '../libs/renderLego'\nimport cropCanvas from '../libs/crop-canvas'\n\nclass LegoRenderer extends Component {\n  constructor(props) {\n    super(props)\n    if (props && props.sourceData) {\n      this.updateCanvas()\n    }\n  }\n\n  componentDidMount() {\n    this.updateCanvas()\n  }\n\n  componentDidUpdate() {\n    this.updateCanvas()\n  }\n\n  updateCanvas() {\n    const { sourceData } = this.props\n\n    if (!sourceData) {\n      console.error('sourceData is undefined')\n      return\n    }\n    convertURIToImageData(sourceData).then(originalImageData => {\n      let { imageData } = remapPixelColours(originalImageData)\n\n      if (!imageData) return\n      this.refs.offscreen_canvas.width = imageData.width\n      this.refs.offscreen_canvas.height = imageData.height\n\n      const ctx = this.refs.offscreen_canvas.getContext('2d')\n      ctx.imageSmoothingEnabled = false\n\n      const scaledImageData = scaleImageData(ctx, imageData, 1)\n      ctx.putImageData(scaledImageData, 0, 0)\n\n      const cropped = cropCanvas(this.refs.offscreen_canvas)\n\n      const largestValue =\n        cropped.width > cropped.height ? cropped.width : cropped.height\n      const tiles = Math.ceil(largestValue / 32)\n\n      const optimalData = calculateFromImageData(cropped)\n\n      renderImageDataAsLego(\n        this.refs.canvas_lego,\n        optimalData,\n        32 * tiles,\n        32 * tiles,\n        Math.floor((32 * tiles - cropped.width) / 2),\n        Math.floor((32 * tiles - cropped.height) / 2)\n      )\n    })\n  }\n\n  drawImageData(canvas, imageData) {\n    const ctx = canvas.getContext('2d')\n    ctx.imageSmoothingEnabled = false\n\n    const pixelScaler = Math.floor(this.props.width / imageData.width)\n\n    const scaledImageData = scaleImageData(ctx, imageData, pixelScaler)\n\n    ctx.putImageData(scaledImageData, 0, 0)\n  }\n\n  render() {\n    return (\n      <div className={this.props.className}>\n        <canvas\n          style={{ position: 'absolute', background: 'red', display: 'none' }}\n          width={96}\n          height={96}\n          ref=\"offscreen_canvas\"\n        />\n        <div className=\"wrapper\">\n          <canvas\n            ref=\"canvas_lego\"\n            width={this.props.width}\n            height={this.props.width}\n          />\n          {/* <canvas\n            ref=\"canvas\"\n            width={this.props.width}\n            height={this.props.width}\n          />\n          <canvas\n            ref=\"original_canvas\"\n            width={this.props.width}\n            height={this.props.width}\n          /> */}\n          <style>{`\n          div.wrapper {\n            display: flex;\n            flex: 1;\n            justify-content: center;\n            flex-direction: column;\n          }\n\n          .wrapper canvas {\n            width: 48vw;\n            height: 48vw;\n            margin: 0 auto;\n            background: white;\n            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.7);\n          }\n        `}</style>\n        </div>\n      </div>\n    )\n  }\n}\n\nLegoRenderer.propTypes = {\n  sourceData: PropTypes.string.isRequired,\n}\n\nexport default withContentRect('bounds')(\n  ({ measureRef, measure, contentRect, ...props }) => (\n    <div ref={measureRef}>\n      <LegoRenderer {...props} {...contentRect.bounds} />\n    </div>\n  )\n)\n","export default function cropImageFromCanvas(canvas) {\n  const ctx = canvas.getContext('2d')\n  let w = canvas.width\n  let h = canvas.height\n  let pix = { x: [], y: [] }\n\n  if (!canvas.width || !canvas.height) return\n  let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height)\n  let x\n  let y\n  let index\n\n  for (y = 0; y < h; y++) {\n    for (x = 0; x < w; x++) {\n      index = (y * w + x) * 4\n      if (imageData.data[index + 3] > 0) {\n        pix.x.push(x)\n        pix.y.push(y)\n      }\n    }\n  }\n  pix.x.sort(function(a, b) {\n    return a - b\n  })\n  pix.y.sort(function(a, b) {\n    return a - b\n  })\n  var n = pix.x.length - 1\n\n  w = pix.x[n] - pix.x[0] + 1\n  h = pix.y[n] - pix.y[0] + 1\n  if (pix.x[0] > 0) {\n    x = pix.x[0] - 1\n    w += 2\n  } else {\n    x = 0\n  }\n  if (pix.y[0] > 0) {\n    y = pix.y[0] - 1\n    h += 2\n  } else {\n    y = 0\n  }\n\n  if (!w || !h) return\n  var cut = ctx.getImageData(x, y, w, h)\n\n  return cut\n}\n"],"sourceRoot":""}